initial revision
modified in the second patch
